<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Oliver Young</title>
  <link href="https://fonts.googleapis.com/css?family=Droid+Serif" rel="stylesheet">
  <link rel="stylesheet" href="/markdown.css">
<style type="text/css">
body {
  margin: 0;
}
#app {
  margin: 0 auto;
}
#social-media {
  margin: 6px;
  float: right;
}
#header {
  margin: 80px auto;
  text-align: center;
  font-family: -apple-system, 'Helvetica Neue';
}
#header h1 {
  font-size: 38px;
  color: #333333;
  font-weight: bold;
  letter-spacing: normal;
}
#header p {
  font-size: 22px;
  color: #A9A9A9;
  -webkit-font-smoothing: antialiased;
}
.divider {
  height: 1px;
  background-color: #E6E6E6;
}
#post-list {
  max-width: 700px;
  margin: 80px auto;
  padding: 0;
}
#post-list li {
  list-style: none;
}
</style><style type="text/css">
.post-list h1 {
  font-size: 20px;
  font-weight: bold;
  letter-spacing: normal;
  margin: 0;
}
.post-list a {
  color: #333;
  text-decoration: none;
}
.post-list a:hover {
  text-decoration: underline;
}
.post-list .date, .post-list .category-and-tags {
  font-size: 12px;
  color: #9E9E9E;
}
.post-list .summary {
  font-size: 14px;
  line-height: 24px;
  color: #333;   
  overflow-wrap: break-word;
}
.post-list-divider {
    margin: 30px auto;
}
</style><style type="text/css">
.entry-title, .entry-meta, .content {
    margin-left: auto;
    margin-right: auto;
    max-width: 700px;
    padding-left: 18px;
    padding-right: 18px;
}
.content {
  margin-top: 60px;
}
.entry-title {
  -webkit-font-smoothing: antialiased;
  margin-top: .42em;
  margin-bottom: .7em;
  letter-spacing: .02em;
  line-height: 1.1;
  color: white;
  font-size: 40px;
  font-weight: 800;
}
.entry-meta {
  font-size: 14px;
  color: rgba(0, 0, 0, .5);
  font-family: Helvetica Neue, sans-serif;
  font-weight: 500;
}
.content img {
  max-width: 100%;
  display: block;
  margin: auto;
}
pre {
  padding: 10px;
  overflow: auto;
  border: #E3EDF3 1px solid;
  background: #F7FAFB;
}
.banner {
  padding: 160px;
  text-align: center;
  background: linear-gradient(to bottom, #545454, #bdbdbd);
}
.content > p:first-child::first-letter {
    float:  left;
    font-size: 56px;
    line-height:  .83;
    padding-top: 3px;
    padding-right: 6px;
    font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
    font-weight: bold;
}
</style><style type="text/css">
#nav a {
  text-decoration: none;
}
#nav {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  height: 55px;
  margin: 0 28px;
  display: flex;
  align-items: center;
  font-size: 13px;
  font-family: Helvetica, sans-serif;
  font-weight: bold;
  color: rgba(0, 0, 0, .48);
  border-bottom: 1px solid rgba(0, 0, 0, .05);
}
#nav::after {
  height: 1px;
  color: rgba(0, 0, 0, .05);
}
.nav-left, .nav-right {
  flex: 1;
  display: flex;
}
.nav-right {
  justify-content: flex-end;
}
.nav-left > .nav-item {
  padding-right: 12px;
}
.nav-right > .nav-item {
  padding-left: 12px;
}
#social-media a {
  font-family: -apple-system;
  color: #8B572A;
}
#social-media a:hover {
  color: #733F10;
}
</style><style type="text/css">
textarea {
  width: 100%;
  height: 400px;
}
.h1 {
  font-size: 24px;
}
</style><style type="text/css">
#app {
  /* max-width: 1080px; */
  margin: 0 auto;
}
#social-media {
  margin: 6px;
  float: right;
}
#header {
  margin: 80px auto;
  text-align: center;
  font-family: -apple-system, 'Helvetica Neue';
}
#header h1 {
  font-size: 38px;
  color: #333333;
}
#header p {
  font-size: 22px;
  color: #A9A9A9;
  -webkit-font-smoothing: antialiased;
}
.divider {
  height: 1px;
  background-color: #E6E6E6;
}
#post-list {
  max-width: 700px;
  margin: 80px auto;
  padding: 0;
}
#post-list li {
  list-style: none;
}
.write-button-container {
  max-width: 700px;
  margin: 0 auto;
  margin-top: 60px;
  text-align: right;
}
.button {
  padding: 8px 16px;
  border: 1px solid rgba(0, 0, 0, .25);
  border-radius: 4px;
  text-decoration: none;
  color: rgba(0, 0, 0, .25);
  font-family: sans-serif;
  font-size: 14px;
}
.button:hover {
  border: 1px solid rgba(0, 0, 0, .45);
  color: rgba(0, 0, 0, .45);
}
</style><style type="text/css">
input, textarea {
  border: none;
}
textarea {
  height: 50px;
}
.title {
  font-size: 20px;
  font-weight: bold;
}
.post-list a:hover {
  text-decoration: underline;
}
.post-list .date, .post-list .category-and-tags {
  font-size: 12px;
  color: #9E9E9E;
}
.post-list .summary {
  font-size: 14px;
  line-height: 24px;
  color: #333;   
  overflow-wrap: break-word;
}
.post-list-divider {
    margin: 30px auto;
}
.operation {
  cursor: pointer;
}
</style><style type="text/css">
.coming-soon {
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    font-size: 44px;
    font-weight: bold;
}
</style></head>
<body>
    <div id="app"><div id="nav"><div class="nav-left"><div class="nav-item"><a href="/blog" class="router-link-active">BLOG</a></div> <div class="nav-item"><a href="/projects" class="">PROJECTS</a></div></div> <div><a href="/" class="router-link-active"><img height="26" id="logo" src="/logo.svg"></a></div> <div class="nav-right"><div class="nav-item"><a href="/about" class="">ABOUT</a></div> <div class="nav-item"><a href="/hire-me" class="">HIRE ME</a></div></div></div> <div class="view"><div class="banner"><h1 class="entry-title">Timezone Matters</h1> <div class="entry-meta">Oct 20, 2017 #javascript #java #swift</div></div> <div class="content"><p>Recently I came across an interesting problem when dealing with date. When using javascript date object, chrome and safari render different result with the same date string. If I run <code>new Date('2017-09-04T09:52:15')</code> in browser deveopler console, chrome will output <code>Mon Sep 04 2017 09:52:15 GMT+0800 (CST)</code> and safari will output <code>Mon Sep 04 2017 17:52:15 GMT+0800 (CST)</code>. </p>
<p>The reason is obvious if you compare the result carefully. Since I lose my timezone information in the date string, the two browsers react differently to this situation. Chrome will take your computer's timezone as default timezone when parsing the date string. Meanwhile safari will take the string as UTC time.</p>
<p>If we could add timezone information to the date string, there won't be such problem. The question is how we add timezone to the date string. Fortunately there is something called <strong>ISO date format</strong>. The format is as follows:</p>
<pre><code>YYYY-MM-DDTHH:mm:ss.sssZ
</code></pre><p>Specific descriptions of each symbol can be found on <a href="https://docs.microsoft.com/en-us/scripting/javascript/date-and-time-strings-javascript#ISO">Microsoft Docs</a>. If you append <code>Z</code> to the end of the above string and run <code>new Date('2017-09-04T09:52:15Z')</code>, chrome and  safari will output the same result. Bingo! We got it.</p>
<h2 id="make-iso-date-format-localized">Make ISO Date Format Localized</h2>
<p>ISO date format is simple but it's not intuitive because we are used to our own timezone which means it needs to be formatted to local date time. Let's see how we can realize that.</p>
<p>JavaScript</p>
<pre><code class="lang-javascript">const isoDateString = "2017-09-04T09:52:15.000Z";
const localizedDateString = new Date(isoDateString).toLocaleString(); 
console.log(localizedDateString); // "9/4/2017, 5:52:15 PM"
</code></pre>
<p>Java</p>
<pre><code class="lang-java">import java.time.format.DateTimeFormatter;
import java.util.Date;
import java.text.SimpleDateFormat;
import java.time.Instant;
import java.time.temporal.TemporalAccessor;

public class ISODateStringToLocalizedDateString {
        public static void main(String[] args) {    
                String isoDateString = "2017-09-29T15:47:36.504Z";
                DateTimeFormatter formatter = DateTimeFormatter.ISO_INSTANT;
                TemporalAccessor accessor = formatter.parse(isoDateString);
                Date date = Date.from(Instant.from(accessor));
                SimpleDateFormat dateFormatter = new SimpleDateFormat();
                String localizedDateString = dateFormatter.format(date);
                System.out.println(localizedDateString); // "9/29/17 11:47 PM"
        }
}
</code></pre>
<p>Swift</p>
<pre><code class="lang-swift">import UIKit

var dateString = "2017-09-04T09:52:15.000Z"
dateString = "\(dateString.components(separatedBy: ".")[0])Z"
let date = ISO8601DateFormatter().date(from: dateString)!
let dateFormatter = DateFormatter()
dateFormatter.dateStyle = .short
dateFormatter.timeStyle = .short
dateFormatter.string(from: date) // "9/4/17, 5:52 PM"
</code></pre>
<h2 id="convert-local-date-to-iso-date-format">Convert Local Date to ISO Date Format</h2>
<p>I got the date string without timezone information from server. So it's reasonable to blame the back-end developer. But when client submit date to server timezone information should also be included. </p>
<p>JavaScript</p>
<pre><code class="lang-javascript">new Date(2017, 09, 04, 17, 30, 30).toISOString(); // "2017-09-29T15:46:22.164Z"
</code></pre>
<p>Java</p>
<pre><code class="lang-java">import java.util.Date;
import java.text.SimpleDateFormat;

public class LocalDateStringToISODateFormat {
    public static void main(String[] args) {
        try {
            SimpleDateFormat df = new SimpleDateFormat("dd/MM/yyyy HH:mm:ss.SSS");
            Date date = df.parse("16/10/2015 15:25:07.861");
            String ISODateString = date.toInstant().toString();
            System.out.println(ISODateString);
        } catch (Exception e) {
            System.out.println(e);
        }
    }
}
new Date().toInstant().toString() // "2017-09-29T15:47:36.504Z"
</code></pre>
<p>Swift</p>
<pre><code class="lang-swift">import UIKit

let localDateString = "2017-09-04 17:30:30"
let dateFormatter = DateFormatter()
dateFormatter.dateFormat = "yyyy-MM-dd HH:mm:ss"
let date = dateFormatter.date(from: localDateString)!
var str = ISO8601DateFormatter().string(from: date)
str.insert(contentsOf: ".000", at: str.index(str.endIndex, offsetBy: -1))
print(str)
</code></pre>
<p>Only when both client and server pass date as ISO format it could be displayed correctly!</p>
</div> <input type="hidden" id="loaded-signal"></div> <p class="copyright">Copyright © 2017 MOVIER.ME - All Rights Reserved.</p></div>
  


</body></html>